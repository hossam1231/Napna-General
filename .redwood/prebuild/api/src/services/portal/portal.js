import { context } from "@redwoodjs/graphql-server";
import { stripe } from "../../lib/stripe";

/**
 * @param {{ userId: int }}
 */
export const portal = async ({
  userId
}) => {
  // eslint-disable-next-line camelcase
  // Create Customer Portal session and send temp url to web side
  return await stripe.billingPortal.sessions.create({
    customer: userId,
    return_url: `${context.request?.headers?.referer ?? process.env.DOMAIN_URL}`
  });
};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJjb250ZXh0Iiwic3RyaXBlIiwicG9ydGFsIiwidXNlcklkIiwiYmlsbGluZ1BvcnRhbCIsInNlc3Npb25zIiwiY3JlYXRlIiwiY3VzdG9tZXIiLCJyZXR1cm5fdXJsIiwicmVxdWVzdCIsImhlYWRlcnMiLCJyZWZlcmVyIiwicHJvY2VzcyIsImVudiIsIkRPTUFJTl9VUkwiXSwic291cmNlcyI6WyIuLi8uLi8uLi8uLi8uLi8uLi9hcGkvc3JjL3NlcnZpY2VzL3BvcnRhbC9wb3J0YWwuanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgc3RyaXBlIH0gZnJvbSAnc3JjL2xpYi9zdHJpcGUnXG5cbi8qKlxuICogQHBhcmFtIHt7IHVzZXJJZDogaW50IH19XG4gKi9cbmV4cG9ydCBjb25zdCBwb3J0YWwgPSBhc3luYyAoeyB1c2VySWQgfSkgPT4ge1xuICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgY2FtZWxjYXNlXG4gIC8vIENyZWF0ZSBDdXN0b21lciBQb3J0YWwgc2Vzc2lvbiBhbmQgc2VuZCB0ZW1wIHVybCB0byB3ZWIgc2lkZVxuICByZXR1cm4gYXdhaXQgc3RyaXBlLmJpbGxpbmdQb3J0YWwuc2Vzc2lvbnMuY3JlYXRlKHtcbiAgICBjdXN0b21lcjogdXNlcklkLFxuICAgIHJldHVybl91cmw6IGAke1xuICAgICAgY29udGV4dC5yZXF1ZXN0Py5oZWFkZXJzPy5yZWZlcmVyID8/IHByb2Nlc3MuZW52LkRPTUFJTl9VUkxcbiAgICB9YCxcbiAgfSlcbn1cbiJdLCJtYXBwaW5ncyI6IlNBV01BLE9BQU87QUFYYixTQUFTQyxNQUFNOztBQUVmO0FBQ0E7QUFDQTtBQUNBLE9BQU8sTUFBTUMsTUFBTSxHQUFHLE9BQU87RUFBRUM7QUFBTyxDQUFDLEtBQUs7RUFDMUM7RUFDQTtFQUNBLE9BQU8sTUFBTUYsTUFBTSxDQUFDRyxhQUFhLENBQUNDLFFBQVEsQ0FBQ0MsTUFBTSxDQUFDO0lBQ2hEQyxRQUFRLEVBQUVKLE1BQU07SUFDaEJLLFVBQVUsRUFBRyxHQUNYUixPQUFPLENBQUNTLE9BQU8sRUFBRUMsT0FBTyxFQUFFQyxPQUFPLElBQUlDLE9BQU8sQ0FBQ0MsR0FBRyxDQUFDQyxVQUNsRDtFQUNILENBQUMsQ0FBQztBQUNKLENBQUMifQ==